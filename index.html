<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Minimalistic Sudoku</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background:#fafafa; }
    h1 { margin:20px 0; }
    #topbar { display:flex; justify-content:center; gap:20px; align-items:center; margin-bottom:10px; }
    #grid { display:grid; grid-template-columns:repeat(9,40px); grid-template-rows:repeat(9,40px);
            justify-content:center; margin:20px auto; border:3px solid black; }
    .cell { border:1px solid #999; display:flex; justify-content:center; align-items:center;
            font-size:18px; cursor:pointer; }
    .prefilled { font-weight:bold; background:#eee; }
    .highlight { background: #cfd9ff !important; }
    .selected { background:#a3ffb9; }
    .wrong { background:#ffcccc; }
    #keyboard { display:flex; justify-content:center; flex-wrap:wrap; gap:5px; margin:10px; }
    #keyboard button { width:40px; height:40px; font-size:16px; cursor:pointer; }
    button { margin:4px; padding:6px 12px; }
    #actions { margin-top:15px; }
  </style>
</head>
<body>
  <h1>Minimalistic Sudoku</h1>

  <div id="topbar">
    <span>‚è± Time: <span id="time">00:00</span></span>
    <span>üèÜ Best: <span id="best">--:--</span></span>
    <button id="pauseBtn">Pause</button>
    <button id="nextBtn">Next</button>
  </div>

  <div id="grid"></div>

  <div id="keyboard"></div>

  <div id="actions">
    <button id="hintBtn">Use Hint (3 left)</button>
    <button id="resetBtn">Reset</button>
    <button id="submitBtn">Submit</button>
  </div>

<script>
/* ---------- Utility ---------- */
function formatTime(sec) {
  const m = String(Math.floor(sec/60)).padStart(2,"0");
  const s = String(sec%60).padStart(2,"0");
  return m+":"+s;
}
function deepCopy(b){ return b.map(r=>r.slice()); }
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

/* ---------- Sudoku Generator ---------- */
function isSafe(board,r,c,n){
  for(let i=0;i<9;i++){ if(board[r][i]==n||board[i][c]==n) return false; }
  const sr=r-r%3, sc=c-sc%3;
  for(let i=0;i<3;i++)for(let j=0;j<3;j++) if(board[sr+i][sc+j]==n) return false;
  return true;
}
function solve(board){
  for(let r=0;r<9;r++)for(let c=0;c<9;c++)if(board[r][c]==0){
    for(let n of shuffle([1,2,3,4,5,6,7,8,9])){
      if(isSafe(board,r,c,n)){ board[r][c]=n; if(solve(board)) return true; board[r][c]=0; }
    }
    return false;
  }
  return true;
}
function genFull(){
  const b=Array.from({length:9},()=>Array(9).fill(0));
  solve(b);
  return b;
}
function genPuzzle(clues=35){
  const full=genFull();
  const sol=deepCopy(full);
  const puzzle=deepCopy(full);
  let cells=[...Array(81).keys()].map(i=>[Math.floor(i/9),i%9]);
  shuffle(cells);
  let remove=81-clues;
  for(let [r,c] of cells){
    if(remove<=0) break;
    const tmp=puzzle[r][c]; puzzle[r][c]=0;
    const copy=deepCopy(puzzle);
    if(solve(copy)) remove--; else puzzle[r][c]=tmp;
  }
  return {puzzle,solution:sol};
}

/* ---------- Game State ---------- */
let puzzle, solution, current, selected=null, seconds=0, timer, paused=false, hintsLeft=3;

/* ---------- DOM Elements ---------- */
const grid=document.getElementById("grid");
const timeEl=document.getElementById("time");
const bestEl=document.getElementById("best");
const pauseBtn=document.getElementById("pauseBtn");
const nextBtn=document.getElementById("nextBtn");
const hintBtn=document.getElementById("hintBtn");
const resetBtn=document.getElementById("resetBtn");
const submitBtn=document.getElementById("submitBtn");
const keyboard=document.getElementById("keyboard");

/* ---------- Timer ---------- */
function startTimer(){
  clearInterval(timer);
  timer=setInterval(()=>{ if(!paused){ seconds++; timeEl.textContent=formatTime(seconds); } },1000);
}

/* ---------- Init Board ---------- */
function buildBoard(){
  grid.innerHTML="";
  for(let r=0;r<9;r++)for(let c=0;c<9;c++){
    const cell=document.createElement("div");
    cell.className="cell";
    if(puzzle[r][c]!==0){
      cell.textContent=puzzle[r][c];
      cell.classList.add("prefilled");
      cell.addEventListener("click",()=>highlightNumber(puzzle[r][c]));
    } else {
      cell.addEventListener("click",()=>selectCell(r,c,cell));
    }
    grid.appendChild(cell);
  }
}

/* ---------- Keyboard ---------- */
function buildKeyboard(){
  keyboard.innerHTML="";
  for(let n=1;n<=9;n++){
    const btn=document.createElement("button");
    btn.textContent=n;
    btn.onclick=()=>fillNumber(n);
    keyboard.appendChild(btn);
  }
  const back=document.createElement("button");
  back.textContent="‚å´";
  back.onclick=()=>fillNumber(0);
  keyboard.appendChild(back);
}

/* ---------- Actions ---------- */
function selectCell(r,c,cell){
  document.querySelectorAll(".cell").forEach(x=>x.classList.remove("selected"));
  cell.classList.add("selected");
  selected={r,c,cell};
}
function fillNumber(n){
  if(!selected) return;
  const {r,c,cell}=selected;
  if(puzzle[r][c]!==0) return; // prefilled
  current[r][c]=n;
  cell.textContent=n===0?"":n;
}
function highlightNumber(val){
  document.querySelectorAll(".cell").forEach(x=>x.classList.remove("highlight"));
  if(!val) return;
  for(let r=0;r<9;r++)for(let c=0;c<9;c++){
    if(puzzle[r][c]===val){
      const idx=r*9+c;
      grid.children[idx].classList.add("highlight");
    }
  }
}
function useHint(){
  if(hintsLeft<=0||!selected) return;
  const {r,c,cell}=selected;
  if(puzzle[r][c]!==0) return;
  current[r][c]=solution[r][c];
  cell.textContent=solution[r][c];
  hintsLeft--;
  hintBtn.textContent="Use Hint ("+hintsLeft+" left)";
}
function resetGame(){
  loadPuzzle();
}
function submitGame(){
  let wrong=0;
  for(let r=0;r<9;r++)for(let c=0;c<9;c++){
    if(current[r][c]!==solution[r][c]) {
      const idx=r*9+c;
      grid.children[idx].classList.add("wrong");
      wrong++;
    }
  }
  if(wrong===0){
    clearInterval(timer);
    alert("üéâ Correct! Time: "+formatTime(seconds));
    let best=localStorage.getItem("sudokuBest");
    if(!best || seconds<parseInt(best)){
      localStorage.setItem("sudokuBest",seconds);
      bestEl.textContent=formatTime(seconds);
    }
  } else {
    alert("‚ùå Wrong moves: "+wrong);
  }
}
function loadPuzzle(){
  ({puzzle,solution}=genPuzzle(35));
  current=deepCopy(puzzle);
  hintsLeft=3;
  hintBtn.textContent="Use Hint (3 left)";
  seconds=0; timeEl.textContent="00:00"; paused=false;
  const best=localStorage.getItem("sudokuBest");
  if(best) bestEl.textContent=formatTime(parseInt(best));
  buildBoard();
  buildKeyboard();
  startTimer();
}

/* ---------- Buttons ---------- */
pauseBtn.onclick=()=>{ paused=!paused; pauseBtn.textContent=paused?"Resume":"Pause"; };
nextBtn.onclick=()=>loadPuzzle();
hintBtn.onclick=()=>useHint();
resetBtn.onclick=()=>resetGame();
submitBtn.onclick=()=>submitGame();

/* ---------- Start ---------- */
loadPuzzle();

</script>
</body>
</html>
